<Window x:Class="StampService.AdminGUI.Views.BackupRecoveryView"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Backup and Recovery" 
   Height="700" Width="900"
  WindowStartupLocation="CenterOwner"
        Background="{DynamicResource MaterialDesignPaper}"
  FontFamily="{materialDesign:MaterialDesignFont}">

    <Grid>
        <Grid.RowDefinitions>
    <RowDefinition Height="Auto"/>
  <RowDefinition Height="*"/>
  <RowDefinition Height="Auto"/>
  </Grid.RowDefinitions>

     <!-- Header -->
 <materialDesign:ColorZone Grid.Row="0" Mode="PrimaryMid" Padding="16">
      <StackPanel Orientation="Horizontal">
     <materialDesign:PackIcon Kind="CloudDownload" Width="28" Height="28" VerticalAlignment="Center" Margin="0,0,12,0"/>
   <TextBlock Text="Backup and Recovery" FontSize="20" VerticalAlignment="Center" FontWeight="Medium"/>
        </StackPanel>
  </materialDesign:ColorZone>

        <!-- Main Content -->
<ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
   <StackPanel Margin="24">

    <!-- Create Backup Section -->
<materialDesign:Card Padding="24" Margin="0,0,0,16" materialDesign:ElevationAssist.Elevation="Dp4">
  <StackPanel>
  <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
 <materialDesign:PackIcon Kind="ContentSave" Width="24" Height="24" VerticalAlignment="Center" Margin="0,0,12,0"/>
<TextBlock Text="Create Backup" FontSize="18" FontWeight="SemiBold" VerticalAlignment="Center"/>
  </StackPanel>

     <TextBlock Text="Create encrypted backup shares using Shamir's Secret Sharing." 
TextWrapping="Wrap"
   Opacity="0.7"
          Margin="0,0,0,16"/>

      <Grid>
     <Grid.ColumnDefinitions>
     <ColumnDefinition Width="150"/>
 <ColumnDefinition Width="200"/>
    <ColumnDefinition Width="*"/>
  </Grid.ColumnDefinitions>
       <Grid.RowDefinitions>
         <RowDefinition Height="Auto"/>
  <RowDefinition Height="Auto"/>
 </Grid.RowDefinitions>

       <TextBlock Grid.Row="0" Grid.Column="0" Text="Total Shares:" VerticalAlignment="Center" Margin="0,0,0,12"/>
     <ComboBox Grid.Row="0" Grid.Column="1" x:Name="TotalSharesComboBox" 
       SelectedIndex="2"
      Style="{StaticResource MaterialDesignOutlinedComboBox}"
   Margin="0,0,0,12">
       <ComboBoxItem Content="3"/>
     <ComboBoxItem Content="4"/>
   <ComboBoxItem Content="5"/>
 <ComboBoxItem Content="7"/>
    <ComboBoxItem Content="10"/>
   </ComboBox>

    <TextBlock Grid.Row="1" Grid.Column="0" Text="Threshold:" VerticalAlignment="Center"/>
   <ComboBox Grid.Row="1" Grid.Column="1" x:Name="ThresholdComboBox" 
SelectedIndex="1"
 Style="{StaticResource MaterialDesignOutlinedComboBox}">
         <ComboBoxItem Content="2"/>
      <ComboBoxItem Content="3"/>
   <ComboBoxItem Content="4"/>
      <ComboBoxItem Content="5"/>
            </ComboBox>
 <TextBlock Grid.Row="1" Grid.Column="2" 
      Text="(Number of shares needed to recover)" 
   VerticalAlignment="Center"
          Opacity="0.7"
        Margin="12,0,0,0"/>
   </Grid>

       <Button x:Name="CreateBackupButton"
      Content="Create Backup Shares"
  Click="CreateBackupButton_Click"
      Style="{StaticResource MaterialDesignRaisedButton}"
     HorizontalAlignment="Left"
    Margin="0,16,0,0"/>

  <ProgressBar x:Name="CreateBackupProgressBar"
   Visibility="Collapsed"
  Height="4"
        Margin="0,8,0,0"/>
 </StackPanel>
   </materialDesign:Card>

    <!-- Recover from Backup Section -->
   <materialDesign:Card Padding="24" materialDesign:ElevationAssist.Elevation="Dp4">
<StackPanel>
      <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
  <materialDesign:PackIcon Kind="Restore" Width="24" Height="24" VerticalAlignment="Center" Margin="0,0,12,0"/>
     <TextBlock Text="Recover from Backup" FontSize="18" FontWeight="SemiBold" VerticalAlignment="Center"/>
     </StackPanel>

     <TextBlock Text="Restore the master key by providing the required number of backup shares." 
      TextWrapping="Wrap"
      Opacity="0.7"
   Margin="0,0,0,16"/>

 <TextBlock x:Name="RecoveryStatusText"
      Text="Shares provided: 0 / 3"
     FontWeight="SemiBold"
  FontSize="14"
     Foreground="Orange"
   Margin="0,0,0,12"/>

    <materialDesign:Card Padding="16" Background="{DynamicResource MaterialDesignDivider}" Margin="0,0,0,16">
        <StackPanel>
<TextBlock Text="Added Shares:" FontWeight="SemiBold" Margin="0,0,0,8"/>
      
     <ListBox x:Name="SharesList"
       MaxHeight="150"
     BorderThickness="1"
  BorderBrush="{DynamicResource MaterialDesignDivider}">
       <!-- Items added programmatically -->
   </ListBox>

       <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,12,0,0">
  <Button Content="+ Add Share File"
Click="AddShareButton_Click"
     Style="{StaticResource MaterialDesignRaisedButton}"
        Margin="0,0,8,0"/>
 <Button Content="Remove Selected"
   Click="RemoveShareButton_Click"
     Style="{StaticResource MaterialDesignOutlinedButton}"
    Margin="0,0,8,0"/>
   <Button Content="Clear All"
    Click="ClearSharesButton_Click"
   Style="{StaticResource MaterialDesignOutlinedButton}"/>
  </StackPanel>
      </StackPanel>
 </materialDesign:Card>

      <Button x:Name="StartRecoveryButton"
    Content="Start Recovery"
     Click="StartRecoveryButton_Click"
  Style="{StaticResource MaterialDesignRaisedButton}"
    IsEnabled="False"
    HorizontalAlignment="Left"/>

     <ProgressBar x:Name="RecoveryProgressBar"
  Visibility="Collapsed"
     Height="4"
     Margin="0,8,0,0"/>

     <materialDesign:Card Padding="16" Background="#FFF3E0" Margin="0,16,0,0">
    <StackPanel>
 <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
         <materialDesign:PackIcon Kind="AlertCircle" Foreground="Orange" VerticalAlignment="Center" Margin="0,0,8,0"/>
      <TextBlock Text="Important Notes" FontWeight="Bold" Foreground="Orange"/>
      </StackPanel>
   <TextBlock TextWrapping="Wrap" FontSize="12">
* Make sure you have the correct number of shares (threshold)
* Shares must be from the same backup set
* Recovery will replace the current master key
* This operation cannot be undone
</TextBlock>
 </StackPanel>
        </materialDesign:Card>
   </StackPanel>
    </materialDesign:Card>

      </StackPanel>
  </ScrollViewer>

   <!-- Footer -->
 <materialDesign:ColorZone Grid.Row="2" Mode="PrimaryLight" Padding="12">
 <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
 <Button Content="Close" 
        Click="CloseButton_Click"
  Style="{StaticResource MaterialDesignRaisedButton}"/>
        </StackPanel>
        </materialDesign:ColorZone>
    </Grid>
</Window>


